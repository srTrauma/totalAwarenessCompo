"use strict";(()=>{var e={};e.id=658,e.ids=[658],e.modules={3524:e=>{e.exports=require("@prisma/client")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},8781:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,n){return n in r?r[n]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,n)):"function"==typeof r&&"default"===n?r:void 0}}})},582:(e,r,n)=>{n.r(r),n.d(r,{config:()=>l,default:()=>d,routeModule:()=>p});var t={};n.r(t),n.d(t,{default:()=>u});var i=n(1802),s=n(7153),o=n(8781);let a=new(n(3524)).PrismaClient;async function u(e,r){if("GET"!==e.method)return r.status(405).json({message:"M\xe9todo no permitido"});try{let{companyId:n}=e.query,t=e.headers.userid;if(!n)return r.status(400).json({message:"El ID de la empresa es obligatorio"});let i=await a.company.findUnique({where:{id:Number(n)}});if(!i)return r.status(404).json({message:"Empresa no encontrada"});let s=await a.userCompany.findUnique({where:{userId_companyId:{userId:Number(t),companyId:Number(n)}},include:{role:!0}}),o=i.ownerId===Number(t),u=s?.role?.level!==void 0&&s.role.level<=2;if(!o&&!u)return r.status(403).json({message:"No tienes permisos para ver las solicitudes pendientes"});let d=await a.userCompany.findMany({where:{companyId:Number(n),approved:!1},include:{user:{select:{id:!0,name:!0,email:!0}},role:!0}});r.status(200).json(d)}catch(e){console.error("Error al obtener solicitudes pendientes:",e),r.status(500).json({message:"Error interno del servidor"})}}let d=(0,o.l)(t,"default"),l=(0,o.l)(t,"config"),p=new i.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/companies/pendingRequest",pathname:"/api/companies/pendingRequest",bundlePath:"",filename:""},userland:t})},7153:(e,r)=>{var n;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,r,n)=>{e.exports=n(145)}};var r=require("../../../webpack-api-runtime.js");r.C(e);var n=r(r.s=582);module.exports=n})();