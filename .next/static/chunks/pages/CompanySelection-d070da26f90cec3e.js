(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[224],{1213:function(e,s,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/CompanySelection",function(){return a(2302)}])},2302:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return d}});var r=a(5893),l=a(7294),t=a(1163),n=a(9008),i=a.n(n),c=a(1029),o=a(1192);function d(){let e=(0,t.useRouter)(),[s,a]=(0,l.useState)(null),[n,d]=(0,l.useState)([]),[m,x]=(0,l.useState)(!1),[u,p]=(0,l.useState)(""),[h,b]=(0,l.useState)(""),[j,g]=(0,l.useState)(!1),[N,f]=(0,l.useState)(!0),[v,y]=(0,l.useState)("");async function w(e){try{f(!0);let s=await fetch("/api/companies/list?userId=".concat(e));if(s.ok){let e=await s.json();d(e)}else{let e=await s.json();y(e.message||"Error al cargar las empresas")}}catch(e){console.error("Error al cargar las empresas:",e),y("Error al conectar con el servidor")}finally{f(!1)}}async function C(){if(!u.trim()){y("El nombre de la empresa es obligatorio");return}try{f(!0);let e=await fetch("/api/companies/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:null==s?void 0:s.id,name:u.trim(),description:h.trim()||null,isPublic:j})});if(e.ok)await e.json(),w(s.id),x(!1),p(""),b(""),g(!1),y("");else{let s=await e.json();y(s.message||"Error al crear la empresa")}}catch(e){console.error("Error al crear la empresa:",e),y("Error al conectar con el servidor")}finally{f(!1)}}return((0,l.useEffect)(()=>{let s=localStorage.getItem("user");if(s){let e=JSON.parse(s);a(e),w(e.id)}else e.push("/Login")},[e]),N&&!n.length)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Selecci\xf3n de Empresa | Total Awareness"})}),(0,r.jsx)(c.Z,{}),(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Selecci\xf3n de Empresa | Total Awareness"})}),(0,r.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(c.Z,{}),(0,r.jsxs)("div",{className:"max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Tus Empresas"}),(0,r.jsxs)("button",{onClick:()=>e.push("/companies/explore"),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(o.U41,{className:"mr-2"})," Explorar empresas p\xfablicas"]})]}),v&&(0,r.jsx)("div",{className:"p-4 mb-6 bg-red-50 border border-red-200 rounded-md text-red-600",children:v}),(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-8",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Selecciona una empresa"}),n.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(s=>(0,r.jsx)("div",{className:"border rounded-lg overflow-hidden hover:shadow-md transition-shadow ".concat(s.approved?"cursor-pointer":"opacity-75"),onClick:()=>(function(s,a){if(!a){alert("Tu solicitud est\xe1 pendiente de aprobaci\xf3n.");return}localStorage.setItem("selectedCompany",String(s)),e.push("/Dashboard")})(s.id,s.approved),children:(0,r.jsxs)("div",{className:"p-5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"bg-blue-100 rounded-full p-2 mr-3",children:(0,r.jsx)(o.m17,{className:"text-blue-600"})}),(0,r.jsx)("h3",{className:"font-semibold text-lg",children:s.name})]}),(0,r.jsx)("div",{children:s.public?(0,r.jsx)(o.ssk,{className:"text-green-600",title:"P\xfablica"}):(0,r.jsx)(o.kUi,{className:"text-gray-600",title:"Privada"})})]}),s.description&&(0,r.jsx)("p",{className:"text-gray-600 mb-3 text-sm",children:s.description}),(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded",children:s.role}),s.isOwner&&(0,r.jsxs)("span",{className:"ml-2 bg-yellow-100 text-yellow-800 px-2 py-1 rounded flex items-center",children:[(0,r.jsx)(o.KE5,{className:"mr-1"})," Propietario"]})]}),!s.approved&&(0,r.jsx)("span",{className:"text-yellow-600",children:"Pendiente de aprobaci\xf3n"})]})]})},s.id))}):(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)(o.m17,{className:"mx-auto text-gray-400 text-5xl mb-4"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"No est\xe1s asociado a ninguna empresa."}),(0,r.jsx)("p",{className:"text-gray-500",children:"Crea una nueva empresa o \xfanete a una existente."})]}),(0,r.jsx)("div",{className:"mt-6",children:(0,r.jsxs)("button",{onClick:()=>x(!0),className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:[(0,r.jsx)(o.wEH,{className:"mr-2"})," Crear nueva empresa"]})})]})}),m&&(0,r.jsx)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden mb-8",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-4",children:"Crear nueva empresa"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de la empresa *"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>p(e.target.value),className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Ingresa el nombre de la empresa"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripci\xf3n"}),(0,r.jsx)("textarea",{value:h,onChange:e=>b(e.target.value),className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"Descripci\xf3n opcional",rows:3})]}),(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{type:"checkbox",id:"isPublic",checked:j,onChange:e=>g(e.target.checked),className:"mr-2"}),(0,r.jsx)("label",{htmlFor:"isPublic",className:"text-sm font-medium text-gray-700",children:"Empresa p\xfablica (cualquier usuario puede unirse sin aprobaci\xf3n)"})]}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{onClick:C,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Crear empresa"}),(0,r.jsx)("button",{onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancelar"})]})]})]})}),(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{onClick:function(){localStorage.removeItem("user"),e.push("/Login")},className:"px-4 py-2 border border-gray-300 bg-white text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cerrar Sesi\xf3n"})})]})]})]})}a(4390)}},function(e){e.O(0,[365,717,912,833,888,774,179],function(){return e(e.s=1213)}),_N_E=e.O()}]);