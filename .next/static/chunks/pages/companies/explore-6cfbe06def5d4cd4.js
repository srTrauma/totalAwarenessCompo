(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[57],{7769:function(e,s,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/companies/explore",function(){return l(4275)}])},4275:function(e,s,l){"use strict";l.r(s),l.d(s,{default:function(){return d}});var a=l(5893),r=l(7294),t=l(1163),n=l(9008),i=l.n(n),c=l(1029),o=l(1192);function d(){let e=(0,t.useRouter)(),[s,l]=(0,r.useState)(null),[n,d]=(0,r.useState)([]),[m,x]=(0,r.useState)([]),[p,u]=(0,r.useState)(""),[h,b]=(0,r.useState)(!0),[j,f]=(0,r.useState)(""),[g,N]=(0,r.useState)("all");async function v(){try{b(!0);let e=await fetch("/api/companies/explore");if(e.ok){let s=await e.json();d(s),x(s)}else{let s=await e.json();f(s.message||"Error al cargar empresas")}}catch(e){console.error("Error al cargar empresas:",e),f("Error al conectar con el servidor")}finally{b(!1)}}async function y(l,a){if(!s){e.push("/Login?redirect=/companies/explore");return}try{let e=await fetch("/api/companies/join",{method:"POST",headers:{"Content-Type":"application/json",userid:s.id.toString()},body:JSON.stringify({userId:s.id,companyId:l})});if(e.ok){let s=await e.json();alert(s.message)}else{let s=await e.json();alert(s.message||"Error al unirse a la empresa")}}catch(e){console.error("Error al unirse a la empresa:",e),alert("Error al conectar con el servidor")}}return(0,r.useEffect)(()=>{let e=localStorage.getItem("user");e&&l(JSON.parse(e)),v()},[]),(0,r.useEffect)(()=>{let e=n;"public"===g?e=e.filter(e=>e.public):"private"===g&&(e=e.filter(e=>!e.public)),p&&(e=e.filter(e=>e.name.toLowerCase().includes(p.toLowerCase())||e.description&&e.description.toLowerCase().includes(p.toLowerCase()))),x(e)},[p,n,g]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(i(),{children:[(0,a.jsx)("title",{children:"Explorar Empresas | Total Awareness"}),(0,a.jsx)("meta",{name:"description",content:"Explora y \xfanete a empresas en Total Awareness"})]}),(0,a.jsxs)("main",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)(c.Z,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsxs)("button",{onClick:function(){s?e.push("/CompanySelection"):e.push("/")},className:"flex items-center text-blue-600 hover:underline mr-4",children:[(0,a.jsx)(o.x_l,{className:"mr-2"})," Volver"]}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Explorar Empresas"})]}),j&&(0,a.jsx)("div",{className:"p-4 mb-6 bg-red-50 border border-red-200 rounded-md text-red-600",children:j}),(0,a.jsxs)("div",{className:"mb-6 flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4",children:[(0,a.jsxs)("div",{className:"relative flex-grow",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(o.U41,{className:"text-gray-400"})}),(0,a.jsx)("input",{type:"text",value:p,onChange:e=>u(e.target.value),className:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",placeholder:"Buscar empresas por nombre o descripci\xf3n..."})]}),(0,a.jsxs)("div",{className:"relative md:w-60",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(o.ulB,{className:"text-gray-400"})}),(0,a.jsxs)("select",{value:g,onChange:e=>N(e.target.value),className:"block w-full pl-10 pr-4 py-3 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 appearance-none",children:[(0,a.jsx)("option",{value:"all",children:"Todas las empresas"}),(0,a.jsx)("option",{value:"public",children:"Solo p\xfablicas"}),(0,a.jsx)("option",{value:"private",children:"Solo privadas"})]}),(0,a.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,a.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]}),h?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):m.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-4 text-sm text-gray-500",children:["Mostrando ",m.length," empresas de ",n.length," totales"]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map(s=>(0,a.jsx)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow ".concat(s.public?"":"border-l-4 border-yellow-500"),children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("div",{className:"rounded-full p-3 mr-3 ".concat(s.public?"bg-blue-100":"bg-yellow-100"),children:(0,a.jsx)(o.m17,{className:"".concat(s.public?"text-blue-600":"text-yellow-600"),size:20})}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-800 truncate max-w-[200px]",children:s.name})]}),(0,a.jsx)("div",{children:s.public?(0,a.jsxs)("span",{className:"flex items-center text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:[(0,a.jsx)(o.ssk,{className:"mr-1"})," P\xfablica"]}):(0,a.jsxs)("span",{className:"flex items-center text-xs bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full",children:[(0,a.jsx)(o.kUi,{className:"mr-1"})," Privada"]})})]}),s.description&&(0,a.jsx)("p",{className:"text-gray-600 mb-4 line-clamp-2",children:s.description}),(0,a.jsxs)("div",{className:"flex items-center text-sm text-gray-500 mb-4",children:[(0,a.jsx)(o.I$,{className:"mr-2"}),(0,a.jsxs)("span",{children:[s.memberCount," miembros"]}),(0,a.jsx)(o.IiJ,{className:"ml-4 mr-2"}),(0,a.jsx)("span",{children:new Date(s.createdAt).toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-medium",children:"Propietario: "}),(0,a.jsx)("span",{className:"text-gray-600",children:s.ownerName})]}),(0,a.jsxs)("div",{className:"mt-5 pt-4 border-t border-gray-100 flex justify-between",children:[(0,a.jsx)("button",{onClick:()=>{var l;return l=s.id,void e.push("/companies/details/".concat(l))},className:"text-blue-600 hover:text-blue-800 font-medium flex items-center",children:(0,a.jsx)("span",{children:"Ver detalles"})}),(0,a.jsx)("button",{onClick:()=>y(s.id,s.public),className:"px-4 py-2 rounded-md transition-colors text-sm ".concat(s.public?"bg-blue-600 text-white hover:bg-blue-700":"bg-yellow-600 text-white hover:bg-yellow-700"),children:s.public?"Unirse":"Solicitar acceso"})]})]})},s.id))})]}):(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-64",children:[(0,a.jsx)(o.m17,{className:"text-gray-400 text-5xl mb-4"}),(0,a.jsx)("p",{className:"text-xl text-gray-500",children:p?"No se encontraron empresas que coincidan con tu b\xfasqueda":"all"!==g?"No hay empresas ".concat("public"===g?"p\xfablicas":"privadas"," disponibles en este momento"):"No hay empresas disponibles en este momento"})]})]})]})]})}l(4390)}},function(e){e.O(0,[365,717,912,833,888,774,179],function(){return e(e.s=7769)}),_N_E=e.O()}]);